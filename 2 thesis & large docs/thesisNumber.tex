
\chapter[Particle Number Distributions]{PARTICLE NUMBER \, DISTRIBUTIONS}
\label{sec:number}

%{\sffamily\small
{\fontfamily{cmss}\fontsize{11}{1}\selectfont When dealing with
neutrons branching processes are often encountered. The
understanding of the number of particles generated and how they
are connected offers a deep insight into the physics of fissile
samples. This chapter details the mathematics needed as well as
the basic concepts behind the processes governing particle
generation.}

\section{Branching processes} \label{sec:branch}

In fissile samples neutrons can be absorbed into a nucleus and
generate a fission event. In that process a number of new neutrons
are born each with the same ability to generate new fissions.
However, not only fissions can take place but also absorptions and
leakage from the sample, which means that the number of neutrons
in the chain is reduced. The full behaviour of the neutrons in the
sample can be depicted as a branching process like the one in Fig.
\ref{fig:branch}.

\begin{figure}%[H]
\centering
\includegraphics[width=0.65\textwidth]{Figures/branch4.eps}
\caption{A branching process, where the event can lead to both
a multiplication of the number of particles but also the removal
of a particle (cf. absorption).}\label{fig:branch}
\end{figure}

Mathematically it can be described in a number of ways depending
on what assumptions and approximations are made. From now on it is
assumed that the particles and sample have no ``memory'', implying
that a particle born later in the branching process will has no
altered behaviour depending on the previous history of the
branching process, such that the new particle have the same
probability to undergo reactions as a previous particle in the
sample. Mathematically it can be expressed using conditional
probabilities in the form of:
\begin{equation}\label{eq:markov}
    Pr(X_{n+1}=x|X_1=x_1,X_2=x_2, \ldots ,X_n=x_n) = Pr(X_{n+1}=x|X_n=x_n),
\end{equation}
where $x_i$ is the state of the random process $X_i$ at different
discrete steps. The generation of neutrons (and also gamma rays)
is considered to follow this behaviour and the process is then
called a \emph{Markov} process \cite{Meyn93}.

\section{Master equations} \label{sec:master}

A way of describing the generation of neutrons and gamma rays
using master equations has been shown by Böhnel \cite{Bohnel85}
and P\'{a}zsit \& Pozzi \cite{Pazsit05}. Considering an
absorption-free system (or alternatively: investigating the total
number of \emph{generated} particles), the only reaction a neutron
can be involved in is an induced fission, which can be assigned a
certain probability, $\mathrm{p}$, and likewise the probability
not to induce fission is $(1-\mathrm{p})$. The first collision
probability is closely linked to the sample mass, the larger the
sample the more likely a neutron will suffer a collision. Using
the tool of probability generating functions it is possible to
define the following generating functions for the probabilities of
the number of neutrons generated in the sample by a single neutron
or by a source event (spontaneous fission), $h(z)$ and $H(z)$,
respectively:
\begin{equation}
\label{eq:hPGF} h(z)= \sum_n p_1(n)z^{n}
\end{equation}
and
\begin{equation}
\label{eq:HPGF} H(z)= \sum_n P(n)z^{n}.
\end{equation}
Here $p_1(n)$ and $P(n)$ are the probabilities to generate $n$
neutrons starting with a single neutron or a spontaneous fission
respectively. By using the PGFs of the neutron distribution from
spontaneous and induced fission:
\begin{equation}
q_{sf}(z)= \sum_n p_{sf}(n)z^{n} \quad , \quad q_i(z)= \sum_n p_i(n)z^{n},
\label{eq:qfPGF}
\end{equation}
a derivation of master equations can be performed by writing down
the probability balance equations. For the probability $p_1(n)$ of
neutrons induced by a single starting neutron, one has, by summing
up the probabilities of the mutually exclusive events of not
having or having a first collision in the sample, the following:
\begin{equation}
p_1(n)=(1-\mathrm{p})\delta_{n,1} + \mathrm{p} \sum_{k=1}^{\infty} p_i(k)
\begin{array}{c}  \quad \quad \quad \quad \quad \sum \quad \quad \quad  \prod^k_{i=1} p_1(n_i) \cr
\{n_1+n_2+ \ldots + n_k=n\} \quad \quad \quad  \end{array}.
\end{equation}

By doing the same also for $P(n)$, and converting the equations
into those for the probability generating functions, a pair of
coupled backward master equations can be derived:
\begin{equation}
\label{eq:hz}
h(z)=(1-\mathrm{p})z+ \mathrm{p} q_i[h(z)]
\end{equation}
and
\begin{equation}
\label{eq:Hz}
H(z)=q_{sf}[h(z)],
\end{equation}
where according to Eq. \eqref{eq:qfPGF}, $q_1[h(z)]=\sum_n p_i(n)
[h(z)]^n$. In Eq. \eqref{eq:hz} the first term represents the
event that the neutron does not induce fission, and the process
then ends there. The second term however, indicates that a number
of new neutrons are generated in the induced fission event, each
of which will be treated independently and thus have the chance to
generate new neutrons themselves according to the generating
function $h(z)$ itself.


\subsection{Gamma ray equations} \label{sec:gammamaster}

For gamma rays the situation is very different compared to
neutrons. The reason is that gamma rays are not self-multiplying
but rather depend on the neutrons for multiplication through
induced fissions. This means that to create master equations
similar to the case of neutrons the formulae needs to be connected
to neutrons rather than gamma rays. The distributions of gamma
rays from induced and spontaneous fissions are also needed, and
their PGFs are defined as follows:
\begin{equation}\label{eq:rf}
r_{sf}(z)= \sum_n f_{sf}(n)z^{n} \quad , \quad r_i(z)= \sum_n f_i(n)z^{n},
\end{equation}
where $f_{sf}(n)$ and $f_{i}(n)$ are the probabilities of
generating $n$ gamma rays in a spontaneous or induced fission,
respectively.

The next step is to define the probabilities $f_1(n)$ and $F(n)$
for the numbers of gamma rays generated by a single neutron or by
a source event, respectively, and their PGFs $g(z)$ and $G(z)$.
The master equations for the generating functions can now be
expressed as:
\begin{equation}
\label{eq:gz} g(z)=(1-\mathrm{p})+ \mathrm{p} r_i(z)q_i[g(z)]
\end{equation}
and
\begin{equation}
\label{eq:Gz} G(z)=r_s(z)q_s[g(z)].
\end{equation}
If the neutron fails to undergo fission, no gamma rays will be
created, while if the neutron does induce a fission, a number of
gamma rays will be generated according to the induced fission
distribution $f_i(n)$. Further, each of the neutrons that are
generated in the same event needs to be accounted for and
independently treated again in the same type of equation. In the
source event, one has both the initial neutrons that can later
create more gamma rays, as well as a number of gamma rays created
directly with probabilities described by the number distribution
of spontaneous fission, $f_{sf}(n)$.

In \textsc{Paper II} the same equations are also derived from a
single joint formalism treating both the neutrons and the gamma
rays together. An additional benefit then is that the joint
moments of neutrons and gamma rays can be directly derived. For a
longer and more complicated derivation of neutron and gamma ray
factorial moments (which is valid only for the individual moments
but not for the mixed ones), and the effect of multiplication on
them, we refer to Oberer's thesis \cite{Oberer02}.


\section{Probability distribution} \label{sec:probdist}

As was described in Section \ref{sec:factmom}, the factorial
moments of the probability distribution $P(n)$ can easily be
obtained by repeated derivations of the generating function
$H(z)$. Whereas the usage of factorial moments is well documented
the calculation of the probability distribution on the other hand
is a new type of analysis. such probabilities were previously
calculated only for a few low order terms. Here we embark on the
calculation of the full probability distribution.

Using the definition of Eq. \eqref{eq:PGF} one can also find an
analogous way to express the probabilities as the Taylor expansion
of the PGF:
\begin{equation}
P(\nu=n)= \left. \frac{1}{n!} \frac{Q^{n}(z)}{dz^{n}}\right|_{z=0}.
\label{eq:prob}
\end{equation}
The main difference is that, compared to the factorial moments,
the expression is evaluated at $z$ equal to zero rather than at
$z=1$. For the higher order terms, this will create additional
terms as compared to the expressions for the factorial moments.
Since PGFs have the property that $Q(z=1)=1$, many terms will be
unity, especially when encountering multiple internal derivatives.
In the case of the probabilities however, this is not the case
when the implicit functions such as  Eq. \eqref{eq:hz} are
evaluated at $z=0$. A great benefit however is that factorial
moments can only be used to reconstruct the probability
distribution once the moments up to high orders are known
\cite{Richards59}, however from the expressions for the
probability distribution the expressions for the same order
factorial moments can be found as a simplified limiting
expression.

A large difference when comparing the factorial moments and the
probabilities is that the 0-th  factorial moment is just equal to
unity, while the lowest order probability is actually a very
important quantity that needs to be calculated for the sake of
completeness. The probability $P(n)$ will contain terms
corresponding to all previous probabilities $P(m), \,\, \forall
\,\,\,\, m<n$. Consequently, the lowest order probability,
corresponding to $h(0)$ in Eq. \eqref{eq:hz}, needs to be
calculated. Inserting $z=0$ gives the following:
\begin{equation}
p_1(0) =  (1-\mathrm{p})z+ \mathrm{p} q_i[h(z)] \big|_{z=0} = \mathrm{p} q_i[p_1(0)] = \mathrm{p}
\sum_{n=0}^{N} p_i(n) [p_1(0)]^{n} \label{eq:p10},
\end{equation}
where $p_1(0)$ is the probability to generate 0 neutrons when
starting with a single neutron. Intuitively it might seem that Eq.
\eqref{eq:p10}, which is a $N$-th order polynomial equation in
$p_1(0)$, is impossible to solve since no generated fission would
lead to keeping the single neutron, and a fission would normally
lead to even more neutrons. However, in a fission process it is
possible to generate also zero neutrons. As can be seen in the
above equation the probability $p_1(0)$ is closely linked to the
first collision probability $\mathrm{p}$.

In the case of $^{240}$Pu $N$ is limited to 8 and Eq.
\eqref{eq:p10} has a single positive root which can be found. A
more detailed investigation and a derivation of the expressions
for the probabilities of the number of generated neutrons and
gamma rays can be found in \textsc{Paper I}. Also in the case of
gamma rays a high order polynomial equation needs to be solved for
the initial probability $f_1(0)$, the order of that equation is
once again decided by the number of \emph{neutrons} that can be
generated in an induced fission event.

The important first collision probability, $\mathrm{p}$, is listed
in Table \ref{tab:pvalue}, for the metallic plutonium samples that
were used in a comparison between the analytical model and
simulations made using the Monte Carlo code MCNP-PoliMi
\cite{Pozzi03}.
\begin{table}[H]%[!htb]
 \centering
\begin{tabular}{c|c|c|c}
Sample & Mass (kg) & $\mathrm{p}$ & $\sigma$ \\ \hline
 1 & 0.335 &  0.0852 & $<$ 0.0002 \\
2 & 2.680 & 0.1678  & $<$ 0.0002\\
3 & 9.047 & 0.2461  & $<$ 0.0002
\end{tabular}
\caption{Probability to induce fission, $\mathrm{p}$, for one
neutron depending on the mass of the sample. The metal spheres
have a composition of 80 wt-\% $^{239}$Pu and 20 wt-\% $^{240}$Pu,
and a density of 15.9 g/cm$^{3}$.} \label{tab:pvalue}
\end{table}

The probabilities $P(n)$ and $F(n)$ for neutrons and gamma rays,
respectively, needs to be calculated up to high order to ensure
that the probability distribution is complete. This can be
achieved by calculating the accumulated probability and stopping
the calculation once a certain threshold is reached such that
$\sum_{n=0}^N P(n) \geq 0.99$, if 99\% of the probability
distribution is desired. For the number of generated particles
this can go as high has $N=100$ depending on the size and
composition of the sample.

In Figure \ref{fig:neutprob} excellent agreement between
simulations done using the code MCNP-Polimi and the analytical
model is shown. To ensure that the comparison is fair the value of
$\mathrm{p}$ is taken from the MCNP-PoliMi simulations, and the
nuclear data constants are taken from the same database. Compared
to the distribution of the spontaneous fission, which is the
limiting case for an infinitesimal sample, the probability
distribution acquires a tail, which means that there is a
increasing probability to have larger neutron bursts generated by
an increased amount of induced fissions.

\begin{figure}[htb]%[H]
\centering
\includegraphics[width=9.5cm]{Figures/probspontneutBIG2.eps}
\caption{Probability distribution of neutrons
 generated for three samples of Pu-metal spheres. The results of
 the analytical model are compared to Monte Carlo simulations using
  MCNP-PoliMi.}\label{fig:neutprob}
\end{figure}

Figure \ref{fig:photprob} shows the probability distribution for
gamma rays for the same samples as used in the neutron analysis.
Similarly to neutrons also the gamma rays acquire a tail to the
distribution. A major difference though is that the gamma rays
have a wider distribution from fissions, as many as 20 can be
generated in a single fission. Considering the fact that larger
numbers of gamma rays are generated also in small samples, they
could be a good candidate for multiplicity assay compared to the
neutrons. However, these are the number of generated particles,
and when also accounting for absorption and detection the
situation can change drastically.

\begin{figure}[hbt]%[H]
\centering
\includegraphics[width=10.0cm]{Figures/gamma45BIG.eps}
\caption{Probability distribution of gamma rays
and the comparison with MCNP-PoliMi for three sample masses.}\label{fig:photprob}
\end{figure}

It can be noted that for the high order probabilities especially
for neutrons, the simulated results show some statistical
scattering. This can be amended by running longer simulations, but
that can become rather time consuming. In the same spirit, the
analytical model is well suited for doing parametric studies to
investigate the dependence for example on the first-collision
probability. Once the formulae have been derived, it is
straightforward to evaluate them with different values of the
parameters such as done for $\mathrm{p}$ in Fig. \ref{fig:surf}.

\begin{figure}[!hbt]%[H]
\centering
\begin{tabular}{cc}
\includegraphics[width=0.45\textwidth]{Figures/surf40BIG.eps}    &

\includegraphics[width=0.45\textwidth]{Figures/surf20gamBIG.eps}
\end{tabular}
\caption{The dependence on the first-collision probability, $p$,
for neutrons and gamma rays, respectively.} \label{fig:surf}
\end{figure}

The value of $\mathrm{p}$ was changed in a range corresponding to
tens of grams up to multiple kilogram quantities. The high order
probabilities continue to increase until we reach a critical
system at $\mathrm{p} = 1/\nu_{i,1}$; beyond that point, the
calculations become irrelevant.


\subsection{What about absorption?} \label{sec:absorption}

The process of absorption can be modelled in different ways
yielding the same result but different equations. In the case of
neutrons, the probability of having an internal absorption in the
sample is very small. The absorption can be modelled together with
the induced fission as one single reaction, yielding a certain
number of new neutrons (zero in the case of absorption). To use
this approach the first-collision probability, $\mathrm{p}$, needs
to be changed to be the probability of either absorption of
fission $\mathrm{p}'$:
\begin{equation}
\label{eq:piprim} \widetilde{p}_i(n)=\frac{\mathrm{p}'-\mathrm{p}}{\mathrm{p}'} \delta_{n,0}
+ \frac{\mathrm{p}}{\mathrm{p}'} p_i(n).
\end{equation}
The benefit of such an approach is that the master equations
remain the same, while only some of the input parameters change.
For gamma rays the same procedure does not work, and the effect of
absorption is two-fold: direct absorption of gamma rays; and also
absorption of neutrons which will reduce the number of induced
fissions and thus reduce the number of generated gamma rays.

The alternative approach is to define generating functions also
for the process of absorption which can be described with a
leakage probability, $l$, and the absorption is then the
reciprocal probability ($1-l$). Formulating it as a probability
generating function in the case of neutrons and gamma rays
respectively gives the following equations:
\begin{subequations}
\label{eq:lz}
  \begin{equation}
     \ell_n(z) = l_{n} z + (1-l_{n}),
  \end{equation}
  \begin{equation}
     \ell_{\gamma}(z) = l_{\gamma} z + (1-l_{\gamma}),
  \end{equation}
\end{subequations}
with $l_n$ and $l_{\gamma}$ being the leakage probability of
neutrons and gamma rays, respectively.


\subsection{Detection probabilities} \label{sec:detection}

Detection is a process that occurs to a generated particle which
escaped absorption and then was detected with a certain detection
probability, $\epsilon$. Like in Eqs. \eqref{eq:lz} this can be
implemented using PGFs:
\begin{subequations}
\label{eq:epsz}
  \begin{equation}
     \varepsilon_n(z) = \epsilon_n\,z + (1 - \epsilon_n),
  \end{equation}
  \begin{equation}
     \varepsilon_{\gamma}(y) = \epsilon_{\gamma}\,z + (1
- \epsilon_{\gamma}).
  \end{equation}
\end{subequations}
The benefit of this approach is that new master equations for the
detection statistics are easily formulated in accordance with:
\begin{equation}
     \label{eq:hd} h_d(z) = h[\ell_n\{\varepsilon_n(z)\}] \quad , \quad H_d(z) =
 H[\ell_n\{\varepsilon_n(z)\}],
  \end{equation}
and in an analog manner for the gamma ray equations. Note can be
made that the equations needed for the 0-th order probability and
the higher order derivatives changes since new terms are
introduced.
\begin{figure}[!htb]%[H]
%\begin{spacing}{1.0}
\centering
\begin{tabular}{r l}
\hspace{-3mm}
\includegraphics[width=0.50\textwidth]{Figures/fig5.eps} &
\includegraphics[width=0.50\textwidth]{Figures/fig6.eps}
\end{tabular}
\caption{Probability distributions with detection included. The results
are obtained from the analytical models. The shape of the curves will
be dependent on the detector efficiency $\epsilon_x$, which was
taken as 10\% for neutrons (a) and 20\% for gamma rays (b) in these plots.}
\label{fig:detection}
%\end{spacing}
\end{figure}

The effect of including absorption is mostly visible for the gamma
rays since a high-Z material such as plutonium is highly
self-shielding for the gamma rays while the neutrons are to large
extent unaffected by absorption. When also adding the process of
detection, the probability distributions reduce even further as is
seen in Fig. \ref{fig:detection}. The ``emitted'' lines are the
result when absorption is taken into account, the large change for
gamma rays is apparent when comparing to Fig. \ref{fig:photprob}.
It is very interesting to note that the probability to detect the
first few multiples is higher for a small sample than for a larger
one. The probabilities $P(n)$ and $F(n)$ are the probability per
source event though, and in a larger sample the rate of such
events will be higher. it is also apparent that although the gamma
rays have higher initial multiplication the neutrons exhibit
larger probability of detecting higher order multiples for this
type of sample.

It is worth noting that the detection probabilities could be
connected to detection rates, by correlating to the number of
source events per mass unit of the specific material. It means
that the probability distribution offers an alternative route to
finding the detection rates  compared to using the factorial
moments investigated in References
\cite{Hage85,Bohnel85,Lu92,Pazsit05,Cifarelli86}. Compared to the
theory mentioned in Section \ref{sec:MC}, there is no mention of
alternative source events other than spontaneous fission.
Especially in materials in oxide or fluoride form there are
usually a large number of neutrons created through ($\alpha,n$)
events. As was noted by Böhnel though, this can also be simply
modelled by creating a compound source and that approach will be
utilized in the next chapter.
